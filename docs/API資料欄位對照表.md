# API 資料欄位對照表

> 對照SPEC 規格需求與推薦 API 提供的資料欄位

---

## 一、規格需求彙整

### 1.1 公司主檔欄位需求

| 欄位 | 說明 | 必要性 |
|------|------|:------:|
| 代號 | 股票代碼 | 必要 |
| 股名 | 股票簡稱 | 必要 |
| 公司名 | 公司全名 | 必要 |
| 產業分類1 | 產業大類 | 必要 |
| 產業分類2 | 產業中類 | 選填 |
| 產品組合 | 主要產品/業務 | 選填 |

### 1.2 VCP 計算所需資料

| 資料項目 | 用途 |
|---------|------|
| 每日 OHLCV | 計算均線 |
| 200+ 天歷史資料 | 計算 MA200 |
| 52 週最高價 | 新高清單判斷 |
| 大盤指數 | 計算大盤漲跌幅 |

### 1.3 三線開花計算所需資料

| 資料項目 | 用途 |
|---------|------|
| 每日 OHLCV | 計算均線 |
| 55 天歷史資料 | 計算 MA55、找次高價 |

---

## 二、台股 API 欄位對照

### 2.1 Fugle API 提供欄位

#### Ticker 端點 (`/intraday/ticker/{symbol}`)

| API 欄位 | 對應規格欄位 | 符合 |
|---------|-------------|:----:|
| `symbol` | 代號 | ✅ |
| `name` | 股名 | ✅ |
| `nameEn` | (英文名) | - |
| `industry` | 產業分類1 | ✅ |
| - | 產業分類2 | ❌ |
| - | 公司名 | ❌ |
| - | 產品組合 | ❌ |

#### Quote 端點 (`/intraday/quote/{symbol}`)

| API 欄位 | 對應規格欄位 | 符合 |
|---------|-------------|:----:|
| `openPrice` | 開盤價 | ✅ |
| `highPrice` | 最高價 | ✅ |
| `lowPrice` | 最低價 | ✅ |
| `closePrice` | 收盤價 | ✅ |
| `total.tradeVolume` | 成交量 | ✅ |
| `change` | 漲跌 | ✅ |
| `changePercent` | 漲跌幅 | ✅ |

#### Historical Stats 端點 (`/historical/stats/{symbol}`)

| API 欄位 | 對應規格欄位 | 符合 |
|---------|-------------|:----:|
| `week52High` | 52 週最高價 | ✅ |
| `week52Low` | 52 週最低價 | ✅ |

#### Historical Candles 端點 (`/historical/candles/{symbol}`)

| API 欄位 | 說明 | 符合 |
|---------|------|:----:|
| `open/high/low/close/volume` | 歷史 OHLCV | ✅ |
| 資料範圍 | 可回溯至 2010 年 | ✅ |

### 2.2 TWSE OpenAPI 補充欄位

| 端點 | 提供資料 | 用途 |
|------|---------|------|
| `STOCK_DAY_ALL` | 全部股票當日交易 | 批次撈取 |
| `BWIBBU_ALL` | 本益比、殖利率、淨值比 | 補充資料 |
| 產業分類頁面 | 類股分類對照 | 產業分類 |

### 2.3 台股欄位符合度總結

| 規格欄位 | Fugle | TWSE | 符合狀態 |
|---------|:-----:|:----:|:--------:|
| 代號 | ✅ | ✅ | ✅ 符合 |
| 股名 | ✅ | ✅ | ✅ 符合 |
| 公司名 | ❌ | ⚠️ 需爬蟲 | ⚠️ 需補充 |
| 產業分類1 | ✅ `industry` | ✅ | ✅ 符合 |
| 產業分類2 | ❌ | ❌ | ❌ 不提供 |
| 產品組合 | ❌ | ❌ | ❌ 不提供 |
| OHLCV | ✅ | ✅ | ✅ 符合 |
| 歷史資料 (200天) | ✅ | ✅ | ✅ 符合 |
| 52週高低點 | ✅ | 需計算 | ✅ 符合 |
| 大盤指數 | ✅ | ✅ | ✅ 符合 |

---

## 三、美股 API 欄位對照

### 3.1 Twelve Data API 提供欄位

#### Profile 端點 (`/profile`)

| API 欄位 | 對應規格欄位 | 符合 |
|---------|-------------|:----:|
| `symbol` | 代號 | ✅ |
| `name` | 股名/公司名 | ✅ |
| `sector` | 產業分類1 | ✅ |
| `industry` | 產業分類2 | ✅ |
| `description` | (公司描述) | - |
| `employees` | (員工數) | - |
| `CEO` | (執行長) | - |
| - | 產品組合 | ❌ |

#### Time Series 端點 (`/time_series`)

| API 欄位 | 對應規格欄位 | 符合 |
|---------|-------------|:----:|
| `open` | 開盤價 | ✅ |
| `high` | 最高價 | ✅ |
| `low` | 最低價 | ✅ |
| `close` | 收盤價 | ✅ |
| `volume` | 成交量 | ✅ |

#### Quote 端點 (`/quote`)

| API 欄位 | 說明 | 符合 |
|---------|------|:----:|
| `fifty_two_week.high` | 52 週最高價 | ✅ |
| `fifty_two_week.low` | 52 週最低價 | ✅ |
| `change` | 漲跌 | ✅ |
| `percent_change` | 漲跌幅 | ✅ |

#### 技術指標端點 (`/sma`, `/ema`)

| API 欄位 | 說明 | 符合 |
|---------|------|:----:|
| `sma` | 簡單移動平均 | ✅ |
| 可設定週期 | 8, 21, 50, 55, 150, 200 日 | ✅ |

### 3.2 美股欄位符合度總結

| 規格欄位 | Twelve Data | 符合狀態 |
|---------|:-----------:|:--------:|
| 代號 | ✅ `symbol` | ✅ 符合 |
| 股名 | ✅ `name` | ✅ 符合 |
| 公司名 | ✅ `name` | ✅ 符合 |
| 產業分類1 | ✅ `sector` | ✅ 符合 |
| 產業分類2 | ✅ `industry` | ✅ 符合 |
| 產品組合 | ❌ | ❌ 不提供 |
| OHLCV | ✅ | ✅ 符合 |
| 歷史資料 (200天) | ✅ 可達數十年 | ✅ 符合 |
| 52週高低點 | ✅ | ✅ 符合 |
| 大盤指數 (SPY/QQQ) | ✅ | ✅ 符合 |
| 均線 (SMA) | ✅ 內建計算 | ✅ 符合 |

---

## 四、計算需求符合度

### 4.1 VCP 強勢股計算

| 計算項目 | 所需資料 | 台股 (Fugle) | 美股 (Twelve Data) |
|---------|---------|:------------:|:-----------------:|
| MA50 | 50 天收盤價 | ✅ 自行計算 | ✅ 內建 `/sma` |
| MA150 | 150 天收盤價 | ✅ 自行計算 | ✅ 內建 `/sma` |
| MA200 | 200 天收盤價 | ✅ 自行計算 | ✅ 內建 `/sma` |
| 20天前 MA200 | 歷史均線 | ✅ 自行計算 | ✅ 可查詢歷史 |
| 近20日漲跌幅 | 20 天收盤價 | ✅ 自行計算 | ✅ 自行計算 |
| 大盤漲跌幅 | 大盤指數 | ✅ 加權指數 | ✅ SPY/QQQ |
| 52週最高價 | 歷史最高 | ✅ `week52High` | ✅ `fifty_two_week.high` |
| 近5日最高價 | 5 天最高價 | ✅ 自行計算 | ✅ 自行計算 |

**VCP 計算結論：✅ 完全符合**

### 4.2 三線開花計算

| 計算項目 | 所需資料 | 台股 (Fugle) | 美股 (Twelve Data) |
|---------|---------|:------------:|:-----------------:|
| MA8 | 8 天收盤價 | ✅ 自行計算 | ✅ 內建 `/sma` |
| MA21 | 21 天收盤價 | ✅ 自行計算 | ✅ 內建 `/sma` |
| MA55 | 55 天收盤價 | ✅ 自行計算 | ✅ 內建 `/sma` |
| 55日內最高價 | 55 天歷史 | ✅ 自行計算 | ✅ 自行計算 |
| 55日內次高價 | 55 天歷史 | ✅ 自行計算 | ✅ 自行計算 |

**三線開花計算結論：✅ 完全符合**

---

## 五、問題欄位處理方案

### 5.1 產品組合（兩市場均不提供）

**問題**：規格要求「產品組合」欄位，但所有 API 均不提供。

**解決方案**：

| 方案 | 說明 | 可行性 |
|------|------|:------:|
| A. 移除欄位 | 與需求方確認是否必要 | ⭐⭐⭐⭐⭐ |
| B. 手動維護 | 建立 Google Sheet 手動更新 | ⭐⭐⭐ |
| C. 爬蟲補充 | 從公開資訊觀測站爬取 | ⭐⭐ |
| D. 第三方資料 | 購買專業財經資料庫 | ⭐ |

**建議**：與需求方確認，建議改為填入「-」或移除此欄位。

### 5.2 公司名（台股需補充）

**問題**：Fugle 只提供 `name`（股名簡稱），不提供完整公司名。

**解決方案**：

| 方案 | 來源 | 可行性 |
|------|------|:------:|
| A. 使用股名 | 以 `name` 欄位代替 | ⭐⭐⭐⭐⭐ |
| B. TWSE 補充 | 從證交所網站取得 | ⭐⭐⭐⭐ |
| C. 建立對照表 | 一次性建立股票代號-公司名對照 | ⭐⭐⭐ |

**建議**：使用 Fugle 的 `name` 欄位（如「台積電」），實務上足夠辨識。

### 5.3 產業分類2（台股需補充）

**問題**：Fugle 只提供一層產業分類。

**解決方案**：

| 方案 | 說明 | 可行性 |
|------|------|:------:|
| A. 填入「-」 | 規格標註為 optional | ⭐⭐⭐⭐⭐ |
| B. TWSE 類股 | 從證交所類股分類取得 | ⭐⭐⭐ |

**建議**：填入「-」，規格已標註為 optional。

---

## 六、最終符合度總結

### 6.1 台股 (Fugle + TWSE)

| 類別 | 符合度 | 說明 |
|------|:------:|------|
| 基本資料 | 80% | 缺公司名(可用股名替代)、產品組合 |
| 價格資料 | 100% | OHLCV 完整 |
| 歷史資料 | 100% | 可回溯至 2010 年 |
| 技術指標 | 100% | 需自行計算，資料充足 |
| 大盤指數 | 100% | 加權指數可取得 |

**台股整體符合度：90%**

### 6.2 美股 (Twelve Data)

| 類別 | 符合度 | 說明 |
|------|:------:|------|
| 基本資料 | 83% | 缺產品組合 |
| 價格資料 | 100% | OHLCV 完整 |
| 歷史資料 | 100% | 可回溯數十年 |
| 技術指標 | 100% | 內建 SMA/EMA 計算 |
| 大盤指數 | 100% | SPY/QQQ 可取得 |

**美股整體符合度：95%**

---

## 七、結論與建議

### ✅ 可完全實現的功能

1. **VCP 強勢股篩選** - 所有計算資料均可取得
2. **三線開花篩選** - 所有計算資料均可取得
3. **每日自動更新** - API 支援批次撈取
4. **產業分類** - 至少一層分類可取得

### ⚠️ 需調整的規格

| 原規格欄位 | 建議調整 | 原因 |
|-----------|---------|------|
| 公司名 | 使用「股名」替代 | API 不提供完整公司名 |
| 產業分類2 | 填入「-」 | 規格標註 optional |
| 產品組合 | 填入「-」或移除 | 所有 API 均不提供 |

### 📋 建議與需求方確認事項

1. **「產品組合」欄位是否為必要？** 若非必要建議移除
2. **「公司名」可否使用股票簡稱替代？** 如「台積電」、「Apple Inc」
3. **「產業分類2」填入「-」是否可接受？**

---

## 附錄：API 端點快速參考

### 台股 (Fugle)

```
基本資料：GET /intraday/ticker/{symbol}
即時報價：GET /intraday/quote/{symbol}
歷史K線：GET /historical/candles/{symbol}
52週統計：GET /historical/stats/{symbol}
市場快照：GET /snapshot/quotes/{market}
```

### 美股 (Twelve Data)

```
公司資料：GET /profile?symbol={symbol}
即時報價：GET /quote?symbol={symbol}
歷史資料：GET /time_series?symbol={symbol}&interval=1day
技術指標：GET /sma?symbol={symbol}&interval=1day&time_period=50
批次查詢：GET /time_series?symbol=AAPL,MSFT,GOOGL&interval=1day
```
